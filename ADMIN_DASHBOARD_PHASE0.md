# 관리자 대시보드 개선 - Phase 0: 요구사항 정리

## 📋 문서 정보
- **작성일**: 2025-01-27
- **프로젝트**: 북살롱 (Book Salon)
- **단계**: Phase 0 - 요구사항 정리
- **상태**: 진행 중

---

## 1. 현재 상태 분석

### 1.1 기존 관리자 기능
✅ **현재 구현된 기능**:
- 관리자 권한 확인 (`AdminService.isAdmin()`)
- 기본 통계 조회 (총 사용자, 포럼, 게시물, 신고)
- 사용자 관리 (활성화/비활성화)
- 포럼 관리 (삭제)
- 신고 관리 (상태 업데이트)
- 실시간 통계 리스너

### 1.2 부족한 기능
❌ **개선이 필요한 부분**:
- 시각화 차트 없음 (숫자만 표시)
- 시간대별/기간별 트렌드 분석 없음
- 상세 분석 지표 부족 (DAU/MAU, 참여도, 리텐션)
- 인기 포럼/게시글 랭킹 없음
- 데이터 집계 최적화 필요 (매번 전체 조회)
- 활동 로그/감사 추적 없음
- 필터링/검색 기능 부족

---

## 2. 사용자 스토리 (User Stories)

### 2.1 관리자 (Admin)
**As a 관리자**, I want to:
1. **서비스 전반의 건강 상태를 한눈에 파악**하고 싶다
   - 전체 사용자 수, 활성 사용자 수 (DAU/MAU)
   - 오늘/이번 주/이번 달 신규 가입자 수
   - 현재 접속 중인 사용자 수 (선택사항)

2. **커뮤니티 활동 추이를 시각적으로 확인**하고 싶다
   - 일별/주별/월별 포럼 생성 추이 (라인 차트)
   - 게시글/댓글 작성 추이 (라인 차트)
   - 좋아요/북마크 활동 추이 (바 차트)

3. **인기 콘텐츠를 빠르게 확인**하고 싶다
   - 인기 포럼 TOP 10 (조회수, 게시글 수 기준)
   - 인기 게시글 TOP 10 (좋아요, 댓글 수 기준)
   - 활발한 사용자 TOP 10 (게시글/댓글 작성 수)

4. **문제가 되는 콘텐츠/사용자를 신속히 파악**하고 싶다
   - 신고 급증 알림
   - 비활성 포럼 리스트 (마지막 활동이 오래된 포럼)
   - 비활성 사용자 리스트 (장기간 미접속)

5. **기간별 데이터를 비교 분석**하고 싶다
   - 이번 주 vs 지난 주 비교
   - 이번 달 vs 지난 달 비교
   - 커스텀 기간 선택 (시작일/종료일)

### 2.2 운영자 (Moderator)
**As a 운영자**, I want to:
1. **신고된 콘텐츠를 효율적으로 처리**하고 싶다
   - 신고 유형별 통계
   - 신고 처리 시간 추적
   - 반복 신고자/피신고자 패턴 파악

2. **커뮤니티 가이드라인 준수 여부를 모니터링**하고 싶다
   - 부적절한 콘텐츠 비율
   - 사용자 신고 빈도

### 2.3 데이터 애널리스트 (Data Analyst)
**As a 데이터 애널리스트**, I want to:
1. **사용자 행동 패턴을 분석**하고 싶다
   - 사용자 리텐션율 (1일/7일/30일)
   - 평균 세션 시간
   - 사용자별 활동 통계

2. **콘텐츠 성과를 측정**하고 싶다
   - 포럼별 참여도
   - 게시글별 조회수/댓글수/좋아요 비율
   - 장르/카테고리별 인기도

---

## 3. 대시보드 뷰 정의

### 3.1 메인 대시보드 (Overview)
**목적**: 서비스 전반의 핵심 지표를 한눈에 파악

**레이아웃**:
```
┌─────────────────────────────────────────────────────────┐
│  📊 대시보드 개요                                         │
│  [기간 선택: 오늘 | 7일 | 30일 | 전체 | 커스텀]          │
├─────────────────────────────────────────────────────────┤
│  ┌──────┐ ┌──────┐ ┌──────┐ ┌──────┐ ┌──────┐         │
│  │ 총   │ │ 활성 │ │ 신규 │ │ 포럼 │ │ 게시물│         │
│  │ 사용자│ │ 사용자│ │ 가입 │ │ 생성 │ │ 작성 │         │
│  │ 1,234│ │  456 │ │  12  │ │  5   │ │  89  │         │
│  └──────┘ └──────┘ └──────┘ └──────┘ └──────┘         │
├─────────────────────────────────────────────────────────┤
│  📈 활동 추이 (라인 차트)                                │
│  [포럼 생성] [게시글 작성] [댓글 작성] [좋아요]          │
│  ┌──────────────────────────────────────────────┐      │
│  │                                              │      │
│  │         (라인 차트 영역)                     │      │
│  │                                              │      │
│  └──────────────────────────────────────────────┘      │
├─────────────────────────────────────────────────────────┤
│  🔥 인기 콘텐츠 TOP 10                                   │
│  ┌──────────────────┐ ┌──────────────────┐            │
│  │ 인기 포럼        │ │ 인기 게시글      │            │
│  │ 1. 책 제목...    │ │ 1. 게시글 제목...│            │
│  │ 2. 책 제목...    │ │ 2. 게시글 제목...│            │
│  └──────────────────┘ └──────────────────┘            │
└─────────────────────────────────────────────────────────┘
```

**핵심 지표 (KPI Cards)**:
- 총 사용자 수 (전체)
- 활성 사용자 수 (DAU/MAU)
- 신규 가입자 수 (선택한 기간)
- 포럼 생성 수 (선택한 기간)
- 게시글 작성 수 (선택한 기간)
- 댓글 작성 수 (선택한 기간)
- 좋아요 수 (선택한 기간)
- 대기 중인 신고 수

**차트**:
- 활동 추이 라인 차트 (일별/주별/월별)
- 활동 유형별 바 차트 (게시글/댓글/좋아요)

**테이블**:
- 인기 포럼 TOP 10
- 인기 게시글 TOP 10
- 활발한 사용자 TOP 10

### 3.2 사용자 분석 (User Analytics)
**목적**: 사용자 행동 패턴 및 참여도 분석

**레이아웃**:
```
┌─────────────────────────────────────────────────────────┐
│  👥 사용자 분석                                           │
│  [필터: 전체 | 활성 | 비활성 | 신규]                     │
├─────────────────────────────────────────────────────────┤
│  📊 사용자 통계                                          │
│  - 총 사용자: 1,234                                      │
│  - 활성 사용자 (30일): 456                               │
│  - 신규 가입자 (7일): 12                                 │
│  - 리텐션율 (7일): 65%                                   │
├─────────────────────────────────────────────────────────┤
│  📈 가입자 추이 (라인 차트)                              │
│  ┌──────────────────────────────────────────────┐      │
│  │                                              │      │
│  └──────────────────────────────────────────────┘      │
├─────────────────────────────────────────────────────────┤
│  🏆 활발한 사용자 TOP 10                                 │
│  [닉네임] [게시글] [댓글] [좋아요] [최근 활동]          │
└─────────────────────────────────────────────────────────┘
```

**지표**:
- 총 사용자 수
- 활성 사용자 수 (DAU/MAU)
- 신규 가입자 추이
- 리텐션율 (1일/7일/30일)
- 평균 세션 시간
- 사용자별 활동 통계

### 3.3 콘텐츠 분석 (Content Analytics)
**목적**: 포럼/게시글 성과 및 인기도 분석

**레이아웃**:
```
┌─────────────────────────────────────────────────────────┐
│  📚 콘텐츠 분석                                           │
│  [필터: 전체 | 장르 | 카테고리]                          │
├─────────────────────────────────────────────────────────┤
│  📊 콘텐츠 통계                                          │
│  - 총 포럼: 234                                          │
│  - 총 게시글: 1,234                                      │
│  - 총 댓글: 5,678                                        │
│  - 평균 게시글/포럼: 5.3                                 │
├─────────────────────────────────────────────────────────┤
│  🔥 인기 포럼 TOP 10                                      │
│  [책 제목] [게시글 수] [댓글 수] [조회수] [생성일]      │
├─────────────────────────────────────────────────────────┤
│  📉 비활성 포럼 (마지막 활동 30일 이상)                  │
│  [책 제목] [마지막 활동] [게시글 수]                     │
└─────────────────────────────────────────────────────────┘
```

**지표**:
- 총 포럼 수
- 총 게시글 수
- 총 댓글 수
- 평균 게시글/포럼
- 인기 포럼 랭킹
- 비활성 포럼 리스트

### 3.4 신고 관리 (Reports Management)
**목적**: 신고 처리 현황 및 패턴 분석

**레이아웃**:
```
┌─────────────────────────────────────────────────────────┐
│  ⚠️ 신고 관리                                             │
│  [필터: 전체 | 대기중 | 검토중 | 해결됨]                 │
├─────────────────────────────────────────────────────────┤
│  📊 신고 통계                                            │
│  - 대기 중: 5                                            │
│  - 검토 중: 2                                            │
│  - 해결됨: 123                                           │
│  - 평균 처리 시간: 2.5시간                               │
├─────────────────────────────────────────────────────────┤
│  📈 신고 유형별 통계 (파이 차트)                         │
│  ┌──────────────────────────────────────────────┐      │
│  │                                              │      │
│  └──────────────────────────────────────────────┘      │
├─────────────────────────────────────────────────────────┤
│  📋 신고 목록                                            │
│  [유형] [신고자] [대상] [상태] [신고일] [처리]          │
└─────────────────────────────────────────────────────────┘
```

**지표**:
- 신고 상태별 통계
- 신고 유형별 통계
- 평균 처리 시간
- 반복 신고자/피신고자 패턴

---

## 4. 접근 권한 설계

### 4.1 역할 정의
- **Admin (관리자)**: 모든 기능 접근 가능
- **Moderator (운영자)**: 신고 관리, 사용자 관리 (제한적)
- **Analyst (분석가)**: 읽기 전용 (통계 조회만)

### 4.2 권한 매트릭스

| 기능 | Admin | Moderator | Analyst |
|------|-------|-----------|---------|
| 대시보드 조회 | ✅ | ✅ | ✅ |
| 사용자 관리 | ✅ | ⚠️ (제한적) | ❌ |
| 포럼 관리 | ✅ | ❌ | ❌ |
| 신고 처리 | ✅ | ✅ | ❌ |
| 통계 조회 | ✅ | ✅ | ✅ |
| 데이터 내보내기 | ✅ | ❌ | ✅ |

### 4.3 보안 규칙
- Firestore Rules: `admins` 컬렉션 기반 권한 확인
- 프론트엔드: `AdminService.isAdmin()` / `isModerator()` 체크
- 라우팅 보호: `/admin/*` 경로는 관리자만 접근

---

## 5. 데이터 모델 설계

### 5.1 집계 데이터 구조

**일별 통계 (daily_metrics)**:
```typescript
interface DailyMetrics {
  date: string; // YYYY-MM-DD
  totalUsers: number;
  activeUsers: number; // DAU
  newUsers: number;
  totalForums: number;
  newForums: number;
  totalPosts: number;
  newPosts: number;
  totalComments: number;
  newComments: number;
  totalLikes: number;
  newLikes: number;
  totalReports: number;
  pendingReports: number;
  resolvedReports: number;
  createdAt: Timestamp;
}
```

**주별 통계 (weekly_metrics)**:
```typescript
interface WeeklyMetrics {
  week: string; // YYYY-WW
  totalUsers: number;
  activeUsers: number; // WAU
  newUsers: number;
  // ... (일별 통계와 유사)
}
```

**월별 통계 (monthly_metrics)**:
```typescript
interface MonthlyMetrics {
  month: string; // YYYY-MM
  totalUsers: number;
  activeUsers: number; // MAU
  newUsers: number;
  retentionRate: number; // 리텐션율
  // ... (일별 통계와 유사)
}
```

### 5.2 랭킹 데이터 구조

**인기 포럼 (popular_forums)**:
```typescript
interface PopularForum {
  isbn: string;
  title: string;
  postCount: number;
  commentCount: number;
  viewCount: number;
  likeCount: number;
  popularityScore: number; // 계산된 인기도 점수
  lastActivityAt: Timestamp;
  rank: number;
  updatedAt: Timestamp;
}
```

**인기 게시글 (popular_posts)**:
```typescript
interface PopularPost {
  postId: string;
  forumIsbn: string;
  title: string;
  authorId: string;
  likeCount: number;
  commentCount: number;
  viewCount: number;
  popularityScore: number;
  createdAt: Timestamp;
  rank: number;
  updatedAt: Timestamp;
}
```

---

## 6. 기술 스택 제안

### 6.1 차트 라이브러리
- **Recharts** (추천): React 친화적, 커스터마이징 용이
- **Chart.js + react-chartjs-2**: 널리 사용됨, 성능 좋음
- **Victory**: 애니메이션 강점

### 6.2 데이터 집계
- **Cloud Functions**: Scheduled Functions로 일/주/월별 집계
- **Firestore**: 집계 결과 저장 (`analytics` 컬렉션)
- **BigQuery** (선택): 장기 데이터 분석용

### 6.3 시각화 컴포넌트
- **KPI Cards**: 숫자 + 아이콘 + 트렌드 표시
- **Line Chart**: 시간대별 추이
- **Bar Chart**: 카테고리별 비교
- **Pie Chart**: 비율 표시
- **Table**: 정렬/필터링 가능한 데이터 테이블

---

## 7. 우선순위 및 일정

### Phase 1: 핵심 지표 및 차트 (1주)
- KPI 카드 개선 (트렌드 표시 추가)
- 활동 추이 라인 차트
- 인기 포럼/게시글 TOP 10 테이블

### Phase 2: 데이터 집계 최적화 (1주)
- Cloud Functions로 일별 통계 집계
- Firestore에 집계 결과 저장
- 실시간 업데이트 최적화

### Phase 3: 고급 분석 기능 (1주)
- 사용자 분석 페이지
- 콘텐츠 분석 페이지
- 필터링/검색 기능

### Phase 4: 추가 기능 (1주)
- 리텐션율 계산
- 비활성 포럼/사용자 리스트
- 데이터 내보내기 (CSV)

---

## 8. 성공 지표

### 8.1 기능 완성도
- [ ] 모든 핵심 지표 표시
- [ ] 차트 시각화 완료
- [ ] 데이터 집계 자동화
- [ ] 필터링/검색 기능

### 8.2 성능
- [ ] 대시보드 로딩 시간 < 2초
- [ ] 차트 렌더링 시간 < 1초
- [ ] 데이터 집계 시간 < 5분 (일별)

### 8.3 사용성
- [ ] 관리자가 원하는 정보를 3클릭 이내로 찾을 수 있음
- [ ] 모바일에서도 사용 가능 (반응형)

---

## 9. 다음 단계

Phase 0 완료 후:
1. Phase 1 시작: 핵심 지표 및 차트 구현
2. 데이터 모델 확정 및 Firestore 구조 설계
3. 차트 라이브러리 선택 및 설치
4. 컴포넌트 구조 설계

---

**작성자**: AI Assistant  
**검토 필요**: 프로젝트 관리자, 개발팀 리더

