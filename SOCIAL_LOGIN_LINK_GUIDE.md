# 소셜 로그인 계정 연결 가이드

## 🎯 기능 설명

구글/카카오 소셜 로그인 시 **동일한 이메일 주소의 기존 계정이 자동으로 연결**됩니다.

## ✅ 작동 방식

### 시나리오 1: 처음 로그인
1. 사용자가 `user@example.com`으로 회원가입
2. 나중에 같은 이메일로 구글/카카오 로그인 시도
3. Firebase가 자동으로 계정 연결 제공
4. **하나의 계정**으로 두 가지 로그인 방법 사용 가능

### 시나리오 2: 이미 소셜 로그인 사용 중
1. 구글로 먼저 로그인
2. 같은 이메일로 일반 이메일/비밀번호 회원가입 시도
3. Firebase가 에러 발생 시 적절한 안내 메시지 표시

## 🔧 Firebase 콘솔 설정

### 1. 계정 연결 활성화
Firebase Console → Authentication → 설정 (톱니바퀴) → 계정 연결:
- ✅ **"동일한 이메일 주소로 계정 자동 연결"** 체크
- 이 설정을 켜면 Firebase가 자동으로 이메일 기반 계정 연결을 시도

### 2. 이메일 제공자 설정 확인
Authentication → 로그인 제공업체:
- ✅ 이메일/비밀번호: 활성
- ✅ Google: 활성
- ✅ OpenID Connect (Kakao): 활성

## 📝 코드 변경사항

### AuthContext.tsx
- `loginWithGoogle()`: 로그인 후 동일 이메일 계정 검사
- `loginWithKakao()`: 로그인 후 동일 이메일 계정 검사
- `auth/account-exists-with-different-credential` 에러 처리

### 사용자 경험
- 소셜 로그인 시 자동으로 계정 연결 시도
- 이미 다른 방법으로 등록된 경우 안내 메시지 표시
- 연결 성공 시 모든 로그인 방법으로 같은 계정 사용 가능

## 🧪 테스트 방법

### 1. 기본 이메일 계정 생성
```
1. 회원가입: user@example.com, password123
2. 로그아웃
```

### 2. 소셜 로그인으로 연결
```
1. 구글 로그인 클릭 (user@example.com 계정 사용)
2. 자동으로 계정이 연결됨
3. 같은 계정으로 두 가지 방법 모두 사용 가능
```

### 3. 반대 방향 테스트
```
1. 먼저 구글로 로그인 (user@example.com)
2. 로그아웃
3. 이메일/비밀번호로 로그인 시도
4. Firebase가 적절하게 처리
```

## ⚠️ 중요 사항

1. **이메일 검증 필요**: Firebase가 자동으로 이메일 주소를 비교
2. **계정 통합**: 연결된 계정은 동일한 Firestore 프로필 공유
3. **보안**: 소셜 로그인은 OAuth 2.0/OpenID Connect 표준 준수

## 🐛 문제 해결

### "계정이 이미 다른 제공자로 로그인됨" 에러
- Firebase 설정에서 계정 연결이 활성화되어 있는지 확인
- 콘솔 → Authentication → 설정 → 계정 연결 체크

### 계정이 연결되지 않음
- 이메일 주소가 정확히 일치하는지 확인
- Firebase 프로젝트 설정에서 허용 도메인 확인

### 연결은 됐지만 프로필이 안 맞음
- Firestore의 `users` 컬렉션에서 `email` 필드 확인
- 중복 프로필이 없는지 확인

